*GitHub Repository "kalloc/near-rnd-example"*

'''--- Cargo.toml ---
[package]
name = "test-for-l2e"
version = "0.1.0"
edition = "2018"

[lib]
crate-type = ["cdylib"]

[dependencies]
near-sdk = "3.1.0"
rand = "0.7.3"

[profile.release]
codegen-units = 1
# Tell `rustc` to optimize for small code size.
opt-level = "z"
lto = true
debug = false
panic = "abort"
# Opt into extra safety checks on arithmetic operations https://stackoverflow.com/a/64136471/249801
overflow-checks = true

'''
'''--- rustfmt.toml ---
max_width = 120
use_small_heuristics = "Max"

'''
'''--- src/lib.rs ---
use std::convert::TryInto;
use std::io::Bytes;

use rand::rngs::StdRng;
use rand::{Rng, SeedableRng};
use near_sdk::borsh::{self, BorshDeserialize, BorshSerialize};
use near_sdk::{env, near_bindgen};

#[near_bindgen]
#[derive(BorshDeserialize, BorshSerialize, Default)]
pub struct Contract {}

#[near_bindgen]
impl Contract {
    pub fn rng(&self) -> u32 {
        let seed: [u8; 32] = env::random_seed().try_into().unwrap();
        let mut rng: StdRng = SeedableRng::from_seed(seed);
        rng.gen_range(1, 10000)
    }
}

#[cfg(test)]
mod tests {
    use near_sdk::test_utils::VMContextBuilder;
    use near_sdk::testing_env;
    use near_sdk::MockedBlockchain;

    use super::Contract;

    #[test]
    fn test_random() {
        let mut context = VMContextBuilder::new();
        context.block_index(1337);
        context.block_timestamp(1234567890);
        context.random_seed(vec![0u8; 32]);
        testing_env!(context.build());
        let contract = Contract {};
        println!("test: {}", contract.rng());
    }
}

'''